(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7421b14c"],{"2c43":function(e,t,a){},"76a8":function(e,t,a){},"926e":function(e,t,a){"use strict";a("76a8")},a7c8:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{xs:24,sm:24,md:24,lg:12,xl:12}},[a("el-card",{staticClass:"card-panel",attrs:{shadow:"never"}},[a("div",{staticStyle:{"min-height":"250px"}},[a("el-form",{attrs:{model:e.form}},[a("el-form-item",{attrs:{label:"GitHub用户"}},[a("img",{staticClass:"avatar",attrs:{src:e.leakageInfo.avatar_url,width:"32",height:"32",alt:"@"+e.leakageInfo.username}})]),a("el-form-item",{attrs:{label:"仓库地址"}},[a("a",{attrs:{href:e.leakageInfo.project_url,target:"_blank",referrerpolicy:"no-referrer"}},[e._v(e._s(e.leakageInfo.project))]),e._v("\n                        –\n                        "),a("a",{attrs:{href:e.leakageInfo.link,target:"_blank",referrerpolicy:"no-referrer"}},[e._v(e._s(e.leakageInfo.filename))])]),a("el-form-item",{attrs:{label:"仓库信息"}},[a("div",{staticClass:"project-info"},[a("img",{attrs:{src:"https://img.shields.io/github/issues/"+e.leakageInfo.project+".svg?longCache=true&style=flat",alt:""}}),a("img",{attrs:{src:"https://img.shields.io/github/forks/"+e.leakageInfo.project+".svg?longCache=true&style=flat",alt:""}}),a("img",{attrs:{src:"https://img.shields.io/github/stars/"+e.leakageInfo.project+".svg?longCache=true&style=flat",alt:""}})])]),a("el-form-item",{attrs:{label:"编码语言"}},[e._v("\n                        "+e._s(e.leakageInfo.language)+"\n                    ")]),a("el-form-item",{attrs:{label:"上传时间"}},[e._v("\n                        "+e._s(e._f("dateFormat")(e.leakageInfo.datetime))+"\n                    ")]),a("el-form-item",{attrs:{label:"命中标签"}},[a("el-tag",{attrs:{size:"mini",type:"danger"}},[a("router-link",{attrs:{to:{name:"index",query:{tag:e.leakageInfo.tag}}}},[e._v(e._s(e.leakageInfo.tag)+"\n                            ")])],1)],1)],1)],1)])],1),a("el-col",{attrs:{xs:24,sm:24,md:24,lg:12,xl:12}},[a("el-card",{staticClass:"card-panel",attrs:{shadow:"never"}},[a("div",{staticStyle:{"min-height":"260px"}},[a("el-form",{attrs:{model:e.form}},[a("el-form-item",{attrs:{label:"是否安全"}},[a("el-radio-group",{model:{value:e.form.security,callback:function(t){e.$set(e.form,"security",t)},expression:"form.security"}},[a("el-radio",{attrs:{label:1}},[e._v("安全")]),a("el-radio",{attrs:{label:0}},[e._v("涉密")])],1)],1),a("el-form-item",{attrs:{label:"忽略仓库"}},[a("el-radio-group",{model:{value:e.form.ignore,callback:function(t){e.$set(e.form,"ignore",t)},expression:"form.ignore"}},[a("el-radio",{attrs:{label:1}},[e._v("忽略")]),a("el-radio",{attrs:{label:0}},[e._v("监控")])],1)],1),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入...",rows:3},model:{value:e.form.desc,callback:function(t){e.$set(e.form,"desc",t)},expression:"form.desc"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",round:"",size:"mini"},on:{click:e.dealLeakage}},[e._v("确认")]),a("el-button",{attrs:{type:"primary",round:"",size:"mini"},on:{click:function(t){return e.quickCheck(e.leakageInfo)}}},[e._v("快速排查\n                        ")])],1)],1)],1)])],1),e.code?a("el-col",{attrs:{span:24}},[a("div",{staticClass:"card"},[a("el-collapse",[a("el-collapse-item",{attrs:{title:"受影响资产 ("+e.affect.length+"个)",name:"affect"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.affect,fit:""}},[a("el-table-column",{attrs:{prop:"type",label:"泄露类型"}}),a("el-table-column",{attrs:{prop:"value",label:"受影响资产"}})],1)],1)],1)],1),a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("i",{staticClass:"el-icon-document",staticStyle:{"margin-right":"4px"}}),a("a",{attrs:{href:e.leakageInfo.link,target:"_blank"}},[e._v("可疑文件")])]),a("highlight-code",{attrs:{lang:"python"}},[e._v("\n                "+e._s(e.code)+"\n            ")])],1)],1):e._e()],1)},s=[],l=(a("6b54"),a("27ae")),o=(a("2c43"),{data:function(){return{leakageInfo:{},code:"",affect:null,form:{security:1,ignore:1,desc:""}}},computed:{leakageID:function(){return this.$route.params.id}},methods:{quickCheck:function(e){var t=e.project_url+"/search?utf8=✓&q=pass OR password OR passwd OR pwd OR smtp OR database";window.open(t,"_blank")},fetchInfoData:function(){var e=this;this.axios.get(this.api.leakageInfo,{params:{id:this.leakageID}}).then((function(t){e.leakageInfo=t.data.result,e.form.security=e.leakageInfo.security,e.form.project=e.leakageInfo.project,e.form.ignore=e.leakageInfo.ignore,e.form.desc=e.leakageInfo.desc})).catch((function(t){e.$message.error(t.toString())}))},fetchCodeData:function(){var e=this;this.axios.get(this.api.leakageCode,{params:{id:this.leakageID}}).then((function(t){e.code=l["Base64"].decode(t.data.result.code),e.affect=t.data.result.affect})).catch((function(t){e.$message.error(t.toString())}))},dealLeakage:function(){var e=this;this.form.id=this.$route.params.id,this.axios.patch(this.api.leakage,this.form).then((function(t){e.$message.success(t.data.msg)})).catch((function(t){e.$message.error(t.toString())}))}},mounted:function(){this.fetchInfoData(),this.fetchCodeData(),this.$nextTick((function(){}))}}),i=o,n=(a("926e"),a("2877")),c=Object(n["a"])(i,r,s,!1,null,null,null);t["default"]=c.exports}}]);